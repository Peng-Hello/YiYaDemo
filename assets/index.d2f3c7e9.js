import{o as f,c as h,a as F,n as v,b as A,r as _,d as y,e as d,u as m,f as I,k as g,g as L,w as N,v as E,h as p,i as R,j as P,F as $,l as V,K as G,m as J,p as U,q as Q}from"./vendor.f3d03773.js";const X=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const l of t)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function o(t){const l={};return t.integrity&&(l.integrity=t.integrity),t.referrerpolicy&&(l.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?l.credentials="include":t.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(t){if(t.ep)return;t.ep=!0;const l=o(t);fetch(t.href,l)}};X();var j=(n,e)=>{const o=n.__vccOpts||n;for(const[i,t]of e)o[i]=t;return o};const Y={},Z={class:"w-full h-44 relative"},ee=F('<img src="https://api.r10086.com/\u52A8\u6F2B\u7EFC\u54081.php" alt="" class="sm:h-full sm:w-full sm:object-cover absolute"><div class="absolute sm:-bottom-3.5 -bottom-1/3 w-2/3 flex" style="left:20%;"><div class="text-7xl">\u{1F600}</div><div class="ml-6"><input id="title" type="text" class="outline-none bg-transparent text-3xl text-white"><input id="tag" type="text" class="outline-none bg-transparent text-xs text-white"></div></div>',2),te=[ee];function ne(n,e){return f(),h("div",Z,te)}var le=j(Y,[["render",ne]]),D={hotkeySettings:{allow_drag_key:"alt",base:[{cmd:"backColor",valList:["orange","crimson","deepskyblue","yellow"],hotKey:["alt+o","alt+r","alt+b","alt+y"]},{cmd:"foreColor",valList:["orange","crimson","deepskyblue","yellow","black","white"],hotKey:["esc+o","esc+r","esc+b","esc+y","esc+z","esc+w"]},{cmd:"bold",hotKey:"ctrl+b"},{cmd:"italic",hotKey:"ctrl+i"},{cmd:"removeFormat",hotKey:"shift+space"},{cmd:"strikeThrough",hotKey:"alt+d"},{cmd:"createLink",hotKey:"ctrl+h"},{cmd:"underline",hotKey:"alt+u"},{cmd:"justifyLeft",hotKey:"ctrl+j"},{cmd:"justifyCenter",hotKey:"ctrl+k"},{cmd:"justifyRight",hotKey:"ctrl+l"},{cmd:"subscript",hotKey:"alt+b"},{cmd:"superscript",hotKey:"alt+s"},{cmd:"fontSize",valList:["1","2","3","4","5","6","7"],hotKey:["alt+1","alt+2","alt+3","alt+4","alt+5","alt+6","alt+7"]}],plugins:[]}};function K(n){for(let e=0;e<n.length;e++){let o=n[e];if(o.indexOf("com-")!==-1)return o.split("-")[1]}return null}function M(n,e){n.classList.contains("savePart")?e.savePart=n.innerHTML:e.savePart=n.querySelectorAll(".savePart")[0].innerHTML}function oe(){let n=document.getElementById("componentContainer").children,e={dataList:[]};for(let l=0;l<n.length-1;l++){const s=n[l];let c={component:"",savePart:null},a=[];if(s.children.length>=2){let r=s.children;for(let u=0;u<r.length;u++){let O=r[u],b={component:"",savePart:null};const B=K(O.classList);B!=null&&(b.component=B),b.component===""&&console.log("\u7F16\u7801\u51FA\u73B0\u9519\u8BEF\uFF01\u8BF7\u68C0\u67E5\u7EC4\u4EF6\u540D\u662F\u5426\u5728classList\u4E2D"),M(O,b),a.push(b)}}else{let r=K(s.children[0].classList);r!=null&&(c.component=r),M(s.children[0],c),a.push(c)}e.dataList.push(a)}let o=JSON.stringify(e),i=document.getElementById("title").value,t=document.getElementById("tag").value;fetch("http://121.37.90.57:8000/postdata",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({tag:t,title:i,passage:o})}).then(l=>l.json()).then(l=>console.log(l)).catch(l=>console.log(l)),console.log(e)}const ie=["id"],se=["contenteditable"],C={setup(n){let e=I(),o=v(),i=A(()=>e.state.allowEdit),t=_(null);return y(()=>{let l="bg-slate-50";t.value.addEventListener("mouseenter",s=>{t.value.classList.add(l)}),t.value.addEventListener("mouseleave",s=>{t.value.classList.remove(l)}),t.value.addEventListener("input",s=>{t.value})}),(l,s)=>(f(),h("li",{id:m(o),class:"w-full flex mb-2 dragula-container"},[d("div",{ref_key:"input_div",ref:t,class:"w-full inline-block outline-none flex-grow input_div savePart com-inputbox drag",contenteditable:m(i)},null,8,se)],8,ie))}};function H(n,e,o){let i=v();const t="<li id="+i+' class="w-full flex mb-2 dragula-container newel"></li>';o!=null?(o.insertAdjacentHTML(n,t),document.getElementById(i).insertAdjacentElement("beforeend",e)):(document.getElementById("componentContainer").insertAdjacentHTML("beforeend",t),document.getElementById(i).insertAdjacentElement("beforeend",e))}function x(n){let e=n.childNodes;for(let o=0;o<e.length;o++)e[o].style.width=n.clientWidth/e.length+"px"}function k(n){let e=document.getElementById("editor"),o=document.getElementById("componentContainer");e.style.height=o.clientHeight+n+"px"}function w(n){if(n.childNodes[0]!=null){let e=document.createRange(),o=window.getSelection();e.setStart(n.childNodes[0],n.childNodes[0].length),e.collapse(!0),o.removeAllRanges(),o.addRange(e)}}function ae(){window.addEventListener("resize",()=>{Array.from(document.getElementById("componentContainer").children,n=>{x(n)})})}function ce(n){g.bind("enter+shift",e=>{if(e.preventDefault(),e.target.innerHTML[0]!="/")new Promise((o,i)=>{n.commit("ADD_COMPONENT",C),o()}).then(()=>{let o=document.activeElement;if(o.classList.contains("input_div")){let i=document.getElementById("componentContainer").children,t=[];for(let l=0;l<i.length;l++)t.push(i[l]);o.parentNode.insertAdjacentElement("afterend",t[t.length-1]),t[t.length-1].childNodes[0].focus()}});else{let o=e.target.innerHTML.substring(1);new Promise((i,t)=>{Se(o,n)?i():alert("\u547D\u4EE4\u627E\u4E0D\u5230\uFF01")}).then(()=>{let i=document.activeElement,t=document.getElementById("componentContainer").children,l=[];for(let s=0;s<t.length;s++)l.push(t[s]);i.parentNode.insertAdjacentElement("afterend",l[l.length-1]),i.parentNode.parentNode.removeChild(i.parentNode)})}}),g.bind("backspace",e=>{if(e.target.innerHTML=="")if(e.target.parentNode.childNodes.length>1){let o=e.target.parentNode.childNodes,i=Array.from(o).indexOf(e.target)-1;if(typeof o[i]!="undefined"){o[i].focus(),new Promise((l,s)=>{setTimeout(()=>{l()},100)}).then(()=>{w(o[i])});let t=e.target.parentNode;e.target.parentNode.removeChild(e.target),x(t),k(600)}}else{let o=e.target.parentNode,i=Array.from(document.getElementById("componentContainer").children);if(i.length>2){let t=i.indexOf(o)-1;typeof i[t]!="undefined"&&(i[t].childNodes[0].focus(),new Promise((l,s)=>{setTimeout(()=>{l()},100)}).then(()=>{w(i[t].childNodes[0])}),o.parentNode.removeChild(o),k(600))}}})}function re(){let n=D.hotkeySettings.base;for(let e=0;e<n.length;e++){let o=n[e],i=o.cmd,t=o.valList,l=o.hotKey;if(typeof t=="undefined")i!="createLink"?g.bind(l,s=>{s.preventDefault(),document.execCommand(i)}):g.bind(l,s=>{s.preventDefault();let c=prompt("\u8F93\u5165\u4F60\u7684\u8D85\u94FE\u63A5:",""),a="";c==null||c==""?console.log("\u672A\u8F93\u5165\u94FE\u63A5\u64CD\u4F5C\u53D6\u6D88\uFF01"):(a=c,document.execCommand(i,!1,a))});else for(let s=0;s<t.length;s++){let c=t[s];g.bind(l[s],a=>{a.preventDefault(),document.execCommand(i,!1,c)})}}}function de(){g.bind("ctrl+s",n=>{n.preventDefault(),alert(ue()),oe()})}function ue(){let n=document.getElementById("componentContainer").innerHTML;return n=n.slice(0,-38),n}function S(n,e,o){n.addEventListener("mouseenter",i=>{o.value=!0}),n.addEventListener("mouseleave",i=>{o.value=!1}),e.addEventListener("mouseenter",i=>{o.value=!0}),e.addEventListener("mouseleave",i=>{o.value=!1})}function z(n){n.have_input_com=!1,n.input_el=null;let e=n.childList;for(let o=0;o<e.length;o++){let i=e[o];if(!i.classList.contains("no_inputBox")){n.have_input_com=!0,n.input_el=i;break}}return n}function T(n){let e=n.target.parentNode.parentNode.parentNode,o=n.target.parentNode.parentNode,i=e.children;if(i.length>=2){let t=z({have_input_com:!1,input_el:null,childList:i});if(t.have_input_com==!1&&t.input_el==null){let l=function(c){if(c.have_input_com==!1&&c.input_el==null){let a=c.childList[0].parentNode;a.nextSibling!=null&&(c.childList=a.nextSibling.children,c=z(c)),l(c)}return c},s=l(t).input_el;s.tagName!="span"&&(s.focus(),w(s)),o.parentNode.removeChild(o),x(e)}else{let l=t.input_el;l.focus(),w(l),o.parentNode.removeChild(o),x(e)}}else{let t=function(s){return s.nextSibling.children[0].tagName!="span"&&s.nextSibling.children[0].classList.contains("no_inputBox")&&(s=s.nextSibling,t(s)),s.nextSibling},l=t(e);l.classList.contains("no")||(l.children[0].focus(),w(l.children[0])),e.parentNode.removeChild(e)}}function W(n){new Promise((e,o)=>{setTimeout(()=>{e()},100)}).then(()=>{n()})}function q(n,e){return document.getElementById(n).querySelector(e)}const fe=["id"],me=["id"],pe=d("div",{class:"w-full h-full flex justify-center"},[d("div",{id:"box",contenteditable:"true",class:"outline-none h-full"})],-1),_e=[pe],he={setup(n){let e=v(),o=v(),i=_(!1),t=_(null),l=_(null);y(()=>{let a=l.value,r=t.value;S(a,r,i)});function s(a){T(a)}function c(){}return y(()=>{W(()=>{q(o,"#box")})}),(a,r)=>{const u=L("ion-icon");return f(),h("li",{id:m(e),ref:"input_li",class:"w-full flex mb-2 dragula-container"},[d("div",{id:m(o),class:"w-full no_inputBox flex flex-grow com-interval drag"},[N(d("p",{ref_key:"ctrl_plane",ref:t,class:"shadow-md rounded-md bg-white flex items-center com-interval flex-grow-0 space-x-1 w-16 justify-center mr-6"},[p(u,{name:"hand-left-outline",class:"handle"}),p(u,{name:"close-circle-outline",onClick:s}),p(u,{name:"refresh-circle-outline",onClick:c})],512),[[E,m(i)]]),d("div",{ref_key:"content",ref:l,class:"flex-grow h-full savePart"},_e,512)],8,me)],8,fe)}}};var ge=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:he});const ve=["id"],ye={class:"w-full no_inputBox flex flex-grow space-x-6 com-ol drag"},xe=d("div",{contenteditable:"true",class:"outline-none h-full w-full"},[d("ul",{class:"list-decimal"},[d("li")])],-1),we=[xe],be={setup(n){let e=v(),o=_(!1),i=_(null),t=_(null);y(()=>{let c=t.value,a=i.value;S(c,a,o)});function l(c){T(c)}function s(){}return(c,a)=>{const r=L("ion-icon");return f(),h("li",{id:m(e),ref:"input_li",class:"w-full flex mb-2 dragula-container"},[d("div",ye,[N(d("p",{ref_key:"ctrl_plane",ref:i,class:"shadow-md rounded-md bg-white flex items-center com-ol flex-grow-0 space-x-1 justify-center"},[p(r,{name:"hand-left-outline",class:"handle"}),p(r,{name:"close-circle-outline",onClick:l}),p(r,{name:"refresh-circle-outline",onClick:s})],512),[[E,m(o)]]),d("div",{ref_key:"content",ref:t,class:"flex-grow h-full savePart"},we,512)])],8,ve)}}};var Le=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:be});const Ne=["id"],Ee=["id"],Ce={setup(n){let e=v(),o=v(),i=_(!1),t=_(null),l=_(null);y(()=>{let a=l.value,r=t.value;S(a,r,i)});function s(a){T(a)}function c(){}return y(()=>{W(()=>{q(o,"#box")})}),(a,r)=>{const u=L("ion-icon");return f(),h("li",{id:m(e),ref:"input_li",class:"w-full flex mb-2 dragula-container"},[d("div",{id:m(o),class:"w-full no_inputBox flex flex-grow com-template drag"},[N(d("p",{ref_key:"ctrl_plane",ref:t,class:"shadow-md rounded-md bg-white flex items-center com-template flex-grow-0 space-x-1 w-16 justify-center mr-6"},[p(u,{name:"hand-left-outline",class:"handle"}),p(u,{name:"close-circle-outline",onClick:s}),p(u,{name:"refresh-circle-outline",onClick:c})],512),[[E,m(i)]]),d("div",{ref_key:"content",ref:l,class:"flex-grow h-full savePart"},null,512)],8,Ee)],8,Ne)}}};var ke=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ce});function Se(n,e){let i=Object.values({"./../../components/plug-in/Interval.vue":ge,"./../../components/plug-in/Ol.vue":Le,"./../../components/plug-in/Template.vue":ke}),t=!0;for(let l=0;l<i.length;l++){let s=i[l].default,c="";{let a=s.setup.toString();c=a.substring(a.indexOf("com-")+4).split(" ")[0]}if(n.toLowerCase()===c){e.commit("ADD_COMPONENT",s);break}l==i.length-1&&(t=!1)}return t}const Te={},Oe={class:"no h-10"},Be=d("span",null,null,-1),Ae=[Be];function Ie(n,e){return f(),h("li",Oe,Ae)}var Pe=j(Te,[["render",Ie]]);const $e={class:"w-full h-screen flex flex-row mt-16 sm:mt-7"},je=d("div",{class:"sm:w-1/5 sm:h-full sm:grow-0"},null,-1),De={id:"editor",class:"w-2/4 grow shadow-xl bg-white mt-1 rounded-md p-5",style:{"border-width":"1px",height:"700px"}},Ke={id:"componentContainer"},Me=d("div",{class:"sm:w-1/5 sm:grow-0"},null,-1),He={setup(n){let e=I(),o=A(()=>e.state.loadList);return y(()=>{ce(e),re(),de(),ae();let i=!1;g.bind(D.hotkeySettings.allow_drag_key,t=>{i=!0},t=>{i=!1}),g.bind("ctrl+r",t=>{t.preventDefault(),e.commit("SET_ALLOWEDIT")}),R([document.getElementById("componentContainer")],{isContainer:function(t){return t.classList.contains("dragula-container")},moves:function(t,l,s,c){let a=!1;return t.classList.contains("no_inputBox")?a=s.classList.contains("handle"):a=i,a},invalid:function(t,l){return t.classList.contains("no")},ignoreInputTextSelection:!0}).on("drop",(t,l,s,c)=>{s.parentNode.id=="componentContainer"&&l.classList.contains("dragula-container")&&(console.log("\u5927\u5BB9\u5668\u8FDB\u5165\u5C0F\u5BB9\u5668"),s.innerHTML==""&&s.parentNode.removeChild(s),x(l)),s.childNodes.length>=1&&l.id=="componentContainer"&&(console.log("\u5C0F\u5BB9\u5668\u8FDB\u5165\u5927\u5BB9\u5668"),H("afterend",t,s),x(s),x(t.parentNode)),s.childNodes.length<1&&l==s.parentNode&&(console.log("\u4E0A\u4E0B\u4EA4\u6362"),new Promise((a,r)=>{H("beforebegin",t,c),a()}).then(()=>{let a=Array.from(document.getElementById("componentContainer").children);for(let r=0;r<a.length;r++)a[r].innerHTML==""&&a[r].parentNode.removeChild(a[r]),a[r].classList.contains("no")&&a.indexOf(a[r])!=a.length-1&&(a[r].parentNode.removeChild(a[r]),document.getElementById("componentContainer").insertAdjacentHTML("beforeend",'<li class="no h-10"><span></span></li>'))}))})}),(i,t)=>(f(),h("div",$e,[je,d("div",De,[d("ul",Ke,[(f(),P(G,null,[(f(!0),h($,null,V(m(o),(l,s)=>(f(),P(J(l),{key:s}))),128))],1024))])]),Me]))}};const ze={setup(n){return(e,o)=>(f(),h($,null,[p(le),p(He)],64))}},We=U({state:{loadList:[C,C,Pe],postdata:{tag:"",title:"",passage:""},allowEdit:!0},getters:{},mutations:{ADD_COMPONENT(n,e){n.loadList.push(e),k(600)},SET_ALLOWEDIT(n){n.allowEdit=!n.allowEdit},SET_INITLIST(n){n.loadList=[]},SET_POST_TAG(n,e){n.postdata.tag=e},SET_POST_TITLE(n,e){n.postdata.title=e},SET_POST_PASSAGE(n,e){n.postdata.passage=e}},actions:{}});Q(ze).use(We).mount("#app");
